<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- åŠ¡å¿…é…ç½®æ­£ç¡®namespace å°±æ˜¯æ‰?æ˜ å°„çš„å®žä½“ç±» -->
<mapper namespace="mapper.taskExcuteTrace">

    <resultMap type="TaskExcuteTrace" id="taskExcuteTraceMap">
        <id column="id" property="id"/>
        <result column="groupName" property="groupName"/>
        <result column="taskId" property="taskId"/>
        <result column="quartzKey" property="quartzKey"/>
        <result column="excuteTime" property="excuteTime"/>
        <result column="status" property="status"/>
        <result column="remark" property="remark"/>
    </resultMap>
    
    <!-- æ–°å¢ž -->
    <insert id="add" parameterType="TaskExcuteTrace" keyProperty="id"
        useGeneratedKeys="true">
        insert into task_excute_trace(
            groupName,
            taskId,
            quartzKey,
            excuteTime,
            status,
            remark
        )
        values
        (
            #{groupName},
            #{taskId},
            #{quartzKey},
            #{excuteTime},
            #{status},
            #{remark}
        )
    </insert>
    
    <!-- æ›´æ–° -->
    <update id="update" parameterType="TaskExcuteTrace">
        update task_excute_trace set 
            groupName=#{groupName},
            taskId=#{taskId},
            quartzKey=#{quartzKey},
            excuteTime=#{excuteTime},
            status=#{status},
            remark=#{remark}
        where 
            id=#{id}
    </update>

    <!-- æ ¹æ®IDåˆ é™¤ -->
    <delete id="removeById" parameterType="int">
        delete from task_excute_trace where id = #{id}
    </delete>
    
    <!-- æ ¹æ®æ¡ä»¶åˆ é™¤ -->
    <delete id="remove" parameterType="TaskExcuteTrace">
        delete from task_excute_trace where 1=1
        <if test="id != null">
            and id=#{id}
        </if>
        <if test="groupName != null">
            and groupName=#{groupName}
        </if>
        <if test="taskId != null">
            and taskId=#{taskId}
        </if>
        <if test="quartzKey != null">
            and quartzKey=#{quartzKey}
        </if>
        <if test="excuteTime != null">
            and excuteTime=#{excuteTime}
        </if>
        <if test="status != null">
            and status=#{status}
        </if>
        <if test="remark != null">
            and remark=#{remark}
        </if>
    </delete>

    <!-- æ ¹æ®idæŸ¥è¯¢ -->
    <select id="getById" resultMap="taskExcuteTraceMap" parameterType="int">
        select * from task_excute_trace where id =#{id}
    </select>

    <!-- æ¡ä»¶æŸ¥è¯¢æ‹¼æŽ¥ -->
    <sql id="findResultsWhere">
        <where>
            <if test="params.id != null">
                and id = #{params.id}
            </if>
            <if test="params.groupName != null">
                and groupName = #{params.groupName}
            </if>
            <if test="params.taskId != null">
                and taskId = #{params.taskId}
            </if>
            <if test="params.quartzKey != null">
                and quartzKey = #{params.quartzKey}
            </if>
            <if test="params.excuteTime != null">
                and excuteTime = #{params.excuteTime}
            </if>
            <if test="params.status != null">
                and status = #{params.status}
            </if>
            <if test="params.remark != null">
                and remark = #{params.remark}
            </if>
        </where>
    </sql>
    
    <!-- æ¡ä»¶æŸ¥è¯¢ -->
    <select id="findResults" resultMap="taskExcuteTraceMap" parameterType="map">
        select * from task_excute_trace  
        <include refid="findResultsWhere"></include>
        <if test="params.page != null">
        limit #{params.page.from}, #{params.page.size}
        </if>
    </select>

    <!-- æ¡ä»¶æŸ¥è¯¢ç»“æžœæ•°é‡ -->
    <select id="findResultCount" resultType="int" parameterType="map">
        select count(1) from task_excute_trace  
         <include refid="findResultsWhere"></include>
    </select>
    
    <!-- æ‰¹é‡æ’å…¥ -->
    <insert id="addBatch" parameterType="iterator" useGeneratedKeys="true">
        insert into task_excute_trace(
            groupName,
            taskId,
            quartzKey,
            excuteTime,
            status,
            remark
        )
        values
        <foreach collection="array" item="item" separator="," >
        (
            #{item.groupName},
            #{item.taskId},
            #{item.quartzKey},
            #{item.excuteTime},
            #{item.status},
            #{item.remark}
        )
        </foreach>
    </insert>
    
</mapper>